var arr=[],Comment=React.createClass({displayName:"Comment",render:function(){var e={marginBottom:20},t={background:"#a8cc45",color:"#805f63",fontSize:14,textIndent:8,height:25,lineHeight:"25px",marginBottom:10};return React.createElement("div",{style:e},React.createElement("div",{style:t},this.props.author),React.createElement("div",null,this.props.children))}}),CommentList=React.createClass({displayName:"CommentList",render:function(){var e=this.props.data.map(function(e){return React.createElement(Comment,{author:e.author},e.text)}),t={marginTop:8};return React.createElement("div",{style:t},e)}}),CommentForm=React.createClass({displayName:"CommentForm",handleClick:function(e){e.preventDefault();var t=this.refs.author.getDOMNode().value,a=this.refs.text.getDOMNode().value;(0!=t.length||0!=a.length)&&this.handleCommentSubmit({author:t,text:a}),this.refs.author.value="",this.refs.text.value=""},handleCommentSubmit:function(e){$.ajax({url:"/commit?name="+e.author+"&talk="+e.text,type:"post",dataType:"json",cache:!1,success:function(t){arr.push({author:e.author,text:e.text}),React.render(React.createElement(CommentBox,null),document.getElementById("commentList"))}.bind(this),error:function(e,t,a){console.error(this.props.url,t,a.toString())}.bind(this)})},render:function(){var e={width:400,margin:"auto"},t={background:"#a5cc8c",height:30,lineHeight:"30px",fontSize:18,textIndent:8,marginBottom:8},a={marginTop:8,display:"block",width:400,height:200},n={display:"block",margin:"8px auto 0",width:150,height:30,lineHeight:"30px",textAlign:"center",textDecoration:"none",color:"#000",background:"#a5cc8c",borderRadius:5};return React.createElement("div",{ref:"forms",style:e},React.createElement("div",{style:t},"发表评论"),React.createElement("label",{"for":""},"用户名："),React.createElement("input",{type:"text",placeholder:"Your name",ref:"author"}),React.createElement("textarea",{style:a,type:"text",placeholder:"Say something...",ref:"text"}),React.createElement("a",{href:"javascript:;",style:n,ref:"post",onClick:this.handleClick},"提交"))}}),CommentBox=React.createClass({displayName:"CommentBox",getInitialState:function(){return{data:[{author:"西泊浪人",text:"晚上吃面条"},{author:"约翰逊",text:"中午吃多了。略撑"}]}},loadCommentsFromServer:function(){$.ajax({url:"/comment",type:"post",dataType:"json",cache:!1,success:function(e){arr=e.result,this.setState({data:e.result})}.bind(this),error:function(e,t,a){console.error(this.props.url,t,a.toString())}.bind(this)})},componentDidMount:function(){this.loadCommentsFromServer()},render:function(){var e={background:"#e5dfe5",margin:"20px auto"},t={background:"#a5cc8c",height:30,lineHeight:"30px",fontSize:18,textIndent:8};return React.createElement("div",{ref:"commentbox",style:e},React.createElement("div",{style:t},"评论列表"),React.createElement(CommentList,{data:this.state.data}),React.createElement(CommentForm,null))}});React.render(React.createElement(CommentBox,null),document.getElementById("commentList"));